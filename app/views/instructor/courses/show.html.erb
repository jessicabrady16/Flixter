<br />
<div class="booyah-box opa col-10 offset-1">
  <div class= 'row'>
    <div class= "col-12">
      <br />
      <h1 class= "text-center img-center">
        <span class = "underline bold"> Course Title:</span> <span> "<%= current_course.title %>"
          <%= link_to 'Preview As Student...', course_path(current_course), class: 'btn btn-warning' %>
          <span> <%= link_to 'Delete Course', instructor_course_path(current_course), method: :delete, data: {confirm: 'Are you sure you want to delete this course?--Your action is irreversible and will remove all the students, sections, and lessons from the course. Click okay to proceed.'},class: 'btn btn-danger button_things' %></span>
        </span>
      </h1>
      <div class = "text-center">
        <% if current_course.image.url%>
          <%= image_tag current_course.image.url, class: 'img-fluid' %>
        <% end %>
        <br />
        <br />
        <hr />
      </div>
    </div>
  </div>
  <div class = "row">
    <div class="col-4 pad-left">
      <div class = "row">
        <h5 class = 'underline inline' > Cost:</h5>
        &nbsp;
        &nbsp;
        <h5 class = "badge badge-primary inline">
          Human Cost:
          <br />
          <%= number_to_currency(current_course.cost) %>
        </h5>
        &nbsp;
        &nbsp;
        <h5 class = "badge badge-primary inline">
          Superior Cat Cost:
          <br />
          <span> ðŸ¥«<%= (current_course.cost/3).to_i %> T.C. (tuna cans) </span>
        </h5>
      </div>
      <br />
      <h5 class = 'underline inline' > Created by: </h5>
      &nbsp;
      &nbsp;
      <div class = "inline"> <%= current_course.user.email %> </div>
      <br />
    </div>
    <br />
    <div class="col-8  border-left">
      <h4 class = 'underline text-left' > Description: </h4>
      <br />
      <%= current_course.description %>
    </div>
    <br />
  </div>
  <hr />
  <div class="col-12">
    <ul class="sections">
      <% current_course.sections.rank(:row_order).each do |section| %>
        <li data-update-url="<%= instructor_section_path section %>" class= "section-li">
          <h3 class= "inline">
            <span class="fa fa-ellipsis-v"></span>
            <%= section.title %>
            <span><%= link_to 'New Lesson', new_instructor_section_lesson_path(section), class: 'float-right btn btn-primary btn-sm' %></span>
            <span> <%= link_to 'Delete Section', instructor_course_section_path(current_course, section), method: :delete, data: {confirm: 'Are you sure you want to delete this?'},class: 'btn btn-danger btn-sm button_things' %></span>
            <br class="clr" />
            <br class="clr" />
          </h3>
          <% if section.lessons.length > 0 %>
            <ul class="lessons">
              <% section.lessons.rank(:row_order).each do |lesson| %>
                <li data-update-url="<%= instructor_lesson_path lesson %>" class="lesson_li" >
                  <div class="row">
                    <div class="col-1">
                      <br />
                      <span class="fa fa-ellipsis-v"></span>
                    </div>
                    <div class="col-11 text-center">
                      <p>
                        <b><%= lesson.title %></b>
                        <span><%= link_to 'Delete Lesson', instructor_section_lesson_path(section, lesson), method: :delete, data: {confirm: 'Are you sure you want to delete this?'},class: 'btn btn-danger button_things btn-sm' %></span>
                      </p>
                      <p>
                        <%= lesson.subtitle %>
                      </p>
                    </div>
                  </div>
                </li>
              <% end %>
            </ul>
          <% end %>
        </li>
      <% end %>
    </ul>
  </div>
  <br />
  <script>
    $(function() {
      $('.sections').sortable({
        update: function( event, ui ) {
          $.ajax({
            type: 'PUT',
            url: ui.item.data('update-url'),
            dataType: 'json',
            data: { section: { row_order_position: ui.item.index()}}
          });
        }
      });

      $('.lessons').sortable({
        update: function( event, ui ) {
          $.ajax({
            type: 'PUT',
            url: ui.item.data('update-url'),
            dataType: 'json',
            data: { lesson: { row_order_position: ui.item.index() } }
          });
        }
      });
     });
  </script>
</div>
